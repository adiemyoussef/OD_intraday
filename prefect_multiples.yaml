# Welcome to your prefect.yaml file! You can use this file for storing and managing
# configuration for deploying your flows. We recommend committing this file to source
# control along with your flow code.

name: OptionsDepth_flows
prefect-version: 2.19.8

build:

push:

deployments:
- name: intraday_flow_deploy
  version:
  tags: [intraday]
  description: "This flow processes intraday financial data for options trading."
  entrypoint: prefect_flow/prefect_tasks.py:Intraday_Flow
  parameters: {}
  work_pool:
    name: intraday-paperspace-agent
    work_queue_name:
    job_variables: {}
  schedules:
  - cron: 0,10,20,30,40,50,0,10,20 8-16 * * 1-5
    timezone: America/New_York
    day_or: true
    active: true

- name: daily_flow_deploy
  version:
  tags: [daily]
  description: "This flow processes daily financial data for options trading."
  entrypoint: prefect_flow/daily_tasks.py:Daily_Flow
  parameters: {}
  work_pool:
    name: daily-paperspace-agent
    work_queue_name:
    job_variables: {}
  schedules:
  - cron: 0 18 * * 1-5
    timezone: America/New_York
    day_or: true
    active: true

- name: weekly_flow_deploy
  version:
  tags: [weekly]
  description: "This flow processes weekly financial data for options trading."
  entrypoint: prefect_flow/weekly_tasks.py:Weekly_Flow
  parameters: {}
  work_pool:
    name: weekly-paperspace-agent
    work_queue_name:
    job_variables: {}
  schedules:
  - cron: 0 20 * * 5
    timezone: America/New_York
    day_or: true
    active: true

storage:
  type: github
  repository: https://github.com/adiemyoussef/OD_intraday.git
  reference: dev_test
  access_token:
    token:

pull:
- prefect.deployments.steps.git_clone:
    repository: https://github.com/adiemyoussef/OD_intraday.git
    branch: dev_test
    access_token: '{{ prefect.blocks.github-credentials.my-github-credentials }}'
- prefect.deployments.steps.run_shell_script:
    script: |
      echo "Cleaning up .prefect/storage directory"
      find ~/.prefect/storage -type f -mtime +7 -delete
      find ~/.prefect/storage -type d -empty -delete
      echo "Cleanup complete"
      echo "Current .prefect directory size:"
      du -sh ~/.prefect
    stream_output: true